<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>MatlabTransportPack: InnerIteration Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.3 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">MatlabTransportPack</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<h1>InnerIteration Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="InnerIteration" --><!-- doxytag: inherits="handle" -->
<p>Solve the within-group transport equation.  
<a href="#_details">More...</a></p>
<div class="dynheader">
Inheritance diagram for InnerIteration:</div>
<div class="dyncontent">
<div class="center"><img src="class_inner_iteration__inherit__graph.png" border="0" usemap="#_inner_iteration_inherit__map" alt="Inheritance graph"/></div>
<map name="_inner_iteration_inherit__map" id="_inner_iteration_inherit__map">
<area shape="rect" id="node5" href="class_g_m_r_e_s_iteration.html" title="Source iteration for inner iterations." alt="" coords="5,843,141,989"/><area shape="rect" id="node7" href="class_krylov_m_g.html" title="Krylov multigroup solver." alt="" coords="165,825,323,1007"/><area shape="rect" id="node9" href="class_livolant.html" title="Livolant acceleration for inner iterations." alt="" coords="347,769,512,1063"/><area shape="rect" id="node11" href="class_source_iteration.html" title="Source iteration for inner iterations." alt="" coords="536,853,667,979"/><area shape="rect" id="node2" href="classhandle.html" title="{handle\n||}" alt="" coords="307,6,365,95"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for InnerIteration:</div>
<div class="dyncontent">
<div class="center"><img src="class_inner_iteration__coll__graph.png" border="0" usemap="#_inner_iteration_coll__map" alt="Collaboration graph"/></div>
<map name="_inner_iteration_coll__map" id="_inner_iteration_coll__map">
<area shape="rect" id="node2" href="classhandle.html" title="{handle\n||}" alt="" coords="23,6,81,95"/></map>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>

<p><a href="class_inner_iteration-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a9665f88f4f8b1457d6c091bebc7722eb">InnerIteration</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Class constructor.  <a href="#a9665f88f4f8b1457d6c091bebc7722eb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#af405785ffeca943f2cdee7ba112c951d">reset_convergence</a> (in this, in max_iters, in tolerance)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Solve the within-group problem.  <a href="#af405785ffeca943f2cdee7ba112c951d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a1379affc9362061afbeafa644d3ac723">display_me</a> (in this)</td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a9040b180689069147acbeafab328e632">setup_base</a> (in this, in)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the base solver.  <a href="#a9040b180689069147acbeafab328e632"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a5b917c946a25951017cd4c081b14de12">initialize_scatter</a> (in this)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Prebuild scattering matrix for each cell.  <a href="#a5b917c946a25951017cd4c081b14de12"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a45390de60d24fa24c5682c4ec2590848">build_scatter_source</a> (in this, in g, in phi)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Build the within-group scattering source.  <a href="#a45390de60d24fa24c5682c4ec2590848"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#af90348b23af56ea6dc09c97ad248c1fc">build_all_scatter_source</a> (in this, in g, in phi)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Build all the scattering sources.  <a href="#af90348b23af56ea6dc09c97ad248c1fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a9bb0fe9a678484606d34bd6959e2af65">build_fixed_source</a> (in this, in g)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Build source for this group excluding within-group scatter.  <a href="#a9bb0fe9a678484606d34bd6959e2af65"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a35b66e9bfebec0c70f4fcffe050f135f">build_external_source</a> (in this, in g)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#ace10a9c9df5378f1047549969803ab8e">check_convergence</a> (in this, in iteration, in flux_error)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a914bc6fe92c0925f28268e9db4f299c2">print_iteration</a> (in this, in it, in e0, in e1, in e2)</td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#abc4c1c33f348e1785b286dd07ff598e9">d_input</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">User input.  <a href="#abc4c1c33f348e1785b286dd07ff598e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a38eee99b593eb74e0865fd7e08aa068c">d_state</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_state.html" title="Represents the state of the problem.">State</a> vectors.  <a href="#a38eee99b593eb74e0865fd7e08aa068c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a76ed28b4b2c303c4668a3f5557e96149">d_boundary</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_boundary.html" title="Holds the incident and outgoing boundary fluxes.">Boundary</a> fluxes.  <a href="#a76ed28b4b2c303c4668a3f5557e96149"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a1d60598afe83dd4c518b6f698814686b">d_mesh</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Problem mesh (either Cartesian mesh or MOC tracking)  <a href="#a1d60598afe83dd4c518b6f698814686b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a6713318a4ce4406dea21e7c7b3c82453">d_mat</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="class_materials.html">Materials</a> definitions.  <a href="#a6713318a4ce4406dea21e7c7b3c82453"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#ae403c267d85e827e85d343e1d2636f85">d_quadrature</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Angular mesh.  <a href="#ae403c267d85e827e85d343e1d2636f85"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a7a2fcc3c6c24a9733333c98d0f63f72c">d_equation</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Spatial discretization.  <a href="#a7a2fcc3c6c24a9733333c98d0f63f72c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a6e008b8b78d0143c216d1286a134b295">d_sweeper</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sweeper over the space-angle domain.  <a href="#a6e008b8b78d0143c216d1286a134b295"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#ae86a46e183bf9e376def5751925ef97e">d_external_source</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">User-defined external source.  <a href="#ae86a46e183bf9e376def5751925ef97e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#ad6f82336625e3ac7774f2bdca1a637ee">d_fission_source</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Fission source, if used.  <a href="#ad6f82336625e3ac7774f2bdca1a637ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a55ba17ea0bb53d0316eb36517fa9c2de">d_fixed_source</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Any source that remains "fixed" within the group solve.  <a href="#a55ba17ea0bb53d0316eb36517fa9c2de"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a06aa521e0ca1b107d33c3e00554352b8">d_scatter_source</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The within group scattering source.  <a href="#a06aa521e0ca1b107d33c3e00554352b8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a9aaac6b46517fc8da97236c5c13cab41">d_sigma_s</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Scattering cross-section vector for faster source computation.  <a href="#a9aaac6b46517fc8da97236c5c13cab41"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a159b3efc31946f48d126625403c25d75">d_max_iters</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a1e03c16fca26f3bdb7e055dbe935af07">d_tolerance</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a631a77bf64364cb27ca5639a3317ed30">d_g</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Property&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_inner_iteration.html#a7425d5935105d1b50919d9ff54305b3b">d_M</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Moments to discrete operator.  <a href="#a7425d5935105d1b50919d9ff54305b3b"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Solve the within-group transport equation. </p>
<p>The within-group transport equation in operator form is </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{L}\psi = \mathbf{MS}\phi + Q \]" src="form_42.png"/>
</p>
<p> where <img class="formulaInl" alt="$ \mathbf{L} $" src="form_43.png"/> is the streaming and collision operator, {M} is the moment-to-discrete operator, {S} is the scattering operator, and Q represents any source considered fixed, which includes in-scatter, fission, and external sources.</p>
<p>What we are really after is the scalar flux and possibly its higher order moments. Consequently, we are able to solve a somewhat different problem then the within group transport equation above. Let us operate on both sides by <img class="formulaInl" alt="$\mathbf{L}^{-1}$" src="form_44.png"/> followed by <img class="formulaInl" alt="$ \mathbf{D}$" src="form_12.png"/> to get </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ (\mathbf{I} - \mathbf{D}\mathbf{L}^{-1}\mathbf{MS})\phi = \mathbf{D} \mathbf{L}^{-1} Q \, . \]" src="form_45.png"/>
</p>
<p> Here, <img class="formulaInl" alt="$\mathbf{D}$" src="form_46.png"/> is the discrete-to-moment operator, defined such that <img class="formulaInl" alt="$ \phi = \mathbf{D}\psi $" src="form_47.png"/>.</p>
<p>Notice this is nothing but a linear system of the form <img class="formulaInl" alt="$ \mathbf{A}x = b $" src="form_48.png"/> where </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{A} = (\mathbf{I} - \mathbf{D}\mathbf{L}^{-1}\mathbf{MS}) \]" src="form_49.png"/>
</p>
<p> and </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ b = \mathbf{D} \mathbf{L}^{-1} Q \, . \]" src="form_50.png"/>
</p>
<p> Moreover, <img class="formulaInl" alt="$ b$" src="form_51.png"/> is just the uncollided flux.</p>
<p>A nice overview of approaches for this inner iteration is given by Larsen and Morel in <em> Nuclear Computational Science </em>. We have implement the standard source iteration method, <a class="el" href="class_livolant.html" title="Livolant acceleration for inner iterations.">Livolant</a> acceleration (an extrapolation technique), and solvers that use MATLAB's own GMRES (and other Krylov solvers).</p>
<p><a class="el" href="class_input.html" title="Stores and processes user input from a driver script.">Input</a> parameters specific to <a class="el" href="class_inner_iteration.html" title="Solve the within-group transport equation.">InnerIteration</a> and derived classes:</p>
<ul>
<li>inner_max_iters (default: 100)</li>
<li>inner_tolerance (default: 1e-5)</li>
</ul>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="class_source_iteration.html" title="Source iteration for inner iterations.">SourceIteration</a>, <a class="el" href="class_livolant.html" title="Livolant acceleration for inner iterations.">Livolant</a>, <a class="el" href="class_g_m_r_e_s_iteration.html" title="Source iteration for inner iterations.">GMRESIteration</a> </dd></dl>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a9665f88f4f8b1457d6c091bebc7722eb"></a><!-- doxytag: member="InnerIteration::InnerIteration" ref="a9665f88f4f8b1457d6c091bebc7722eb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function <a class="el" href="class_inner_iteration.html">InnerIteration</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Class constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td><a class="el" href="class_input.html" title="Stores and processes user input from a driver script.">Input</a> database. </td></tr>
    <tr><td class="paramname">state</td><td><a class="el" href="class_state.html" title="Represents the state of the problem.">State</a> vectors, etc. </td></tr>
    <tr><td class="paramname">boundary</td><td><a class="el" href="class_boundary.html" title="Holds the incident and outgoing boundary fluxes.">Boundary</a> fluxes. </td></tr>
    <tr><td class="paramname">mesh</td><td>Problem mesh. </td></tr>
    <tr><td class="paramname">mat</td><td>Material definitions. </td></tr>
    <tr><td class="paramname">quadrature</td><td>Angular mesh.. </td></tr>
    <tr><td class="paramname">external_source</td><td>User-defined external source. </td></tr>
    <tr><td class="paramname">fission_source</td><td>Fission source.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Instance of the <a class="el" href="class_inner_iteration.html" title="Solve the within-group transport equation.">InnerIteration</a> class. </dd></dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="af90348b23af56ea6dc09c97ad248c1fc"></a><!-- doxytag: member="InnerIteration::build_all_scatter_source" ref="af90348b23af56ea6dc09c97ad248c1fc" args="(in this, in g, in phi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function build_all_scatter_source </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build all the scattering sources. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>Group for this problem. (I.e. row in MG). </td></tr>
    <tr><td class="paramname">phi</td><td>Current MG flux. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a35b66e9bfebec0c70f4fcffe050f135f"></a><!-- doxytag: member="InnerIteration::build_external_source" ref="a35b66e9bfebec0c70f4fcffe050f135f" args="(in this, in g)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function build_external_source </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9bb0fe9a678484606d34bd6959e2af65"></a><!-- doxytag: member="InnerIteration::build_fixed_source" ref="a9bb0fe9a678484606d34bd6959e2af65" args="(in this, in g)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function build_fixed_source </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>g</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build source for this group excluding within-group scatter. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>Group for this problem. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a45390de60d24fa24c5682c4ec2590848"></a><!-- doxytag: member="InnerIteration::build_scatter_source" ref="a45390de60d24fa24c5682c4ec2590848" args="(in this, in g, in phi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function build_scatter_source </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>phi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Build the within-group scattering source. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>Group for this problem. </td></tr>
    <tr><td class="paramname">phi</td><td>Current group flux. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ace10a9c9df5378f1047549969803ab8e"></a><!-- doxytag: member="InnerIteration::check_convergence" ref="ace10a9c9df5378f1047549969803ab8e" args="(in this, in iteration, in flux_error)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function check_convergence </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>flux_error</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1379affc9362061afbeafa644d3ac723"></a><!-- doxytag: member="InnerIteration::display_me" ref="a1379affc9362061afbeafa644d3ac723" args="(in this)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function display_me </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5b917c946a25951017cd4c081b14de12"></a><!-- doxytag: member="InnerIteration::initialize_scatter" ref="a5b917c946a25951017cd4c081b14de12" args="(in this)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function initialize_scatter </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em></td><td>)</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Prebuild scattering matrix for each cell. </p>
<p>While not the most *memory* efficient, this saves *time* by eliminate lots of loops. </p>

</div>
</div>
<a class="anchor" id="a914bc6fe92c0925f28268e9db4f299c2"></a><!-- doxytag: member="InnerIteration::print_iteration" ref="a914bc6fe92c0925f28268e9db4f299c2" args="(in this, in it, in e0, in e1, in e2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function print_iteration </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>it</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>e0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>e1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>e2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af405785ffeca943f2cdee7ba112c951d"></a><!-- doxytag: member="InnerIteration::reset_convergence" ref="af405785ffeca943f2cdee7ba112c951d" args="(in this, in max_iters, in tolerance)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function reset_convergence </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>max_iters</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>tolerance</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Solve the within-group problem. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">g</td><td>Group of the problem to be solved.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Flux residual (L-inf norm) and iteration count. Reset convergence criteria. It can be useful to use a dynamically changing convergence criteria, especially for eigenproblems. For regular power iteration, it is wasteful to use tight tolerances on the inners when the source is not as tightly known.</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">max_iters</td><td>Maximum number of iterations. </td></tr>
    <tr><td class="paramname">tolerance</td><td>Maximum point-wise error in flux </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a9040b180689069147acbeafab328e632"></a><!-- doxytag: member="InnerIteration::setup_base" ref="a9040b180689069147acbeafab328e632" args="(in this, in)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">function setup_base </td>
          <td>(</td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname"><em>this</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">in&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Setup the base solver. </p>
<p>By keeping everything out of the constructor, we can avoid having to copy the signature for all derived classes, both in their definitions and whereever thisects are instantiated. However, derived classes have other setup issues that need to be done, and so this serves as a general setup function that <em>must</em> be called before other setup stuff.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td><a class="el" href="class_input.html" title="Stores and processes user input from a driver script.">Input</a> database. </td></tr>
    <tr><td class="paramname">state</td><td><a class="el" href="class_state.html" title="Represents the state of the problem.">State</a> vectors, etc. </td></tr>
    <tr><td class="paramname">boundary</td><td><a class="el" href="class_boundary.html" title="Holds the incident and outgoing boundary fluxes.">Boundary</a> fluxes. </td></tr>
    <tr><td class="paramname">mesh</td><td>Problem mesh. </td></tr>
    <tr><td class="paramname">mat</td><td>Material definitions. </td></tr>
    <tr><td class="paramname">quadrature</td><td>Angular mesh.. </td></tr>
    <tr><td class="paramname">external_source</td><td>User-defined external source. </td></tr>
    <tr><td class="paramname">fission_source</td><td>Fission source. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a76ed28b4b2c303c4668a3f5557e96149"></a><!-- doxytag: member="InnerIteration::d_boundary" ref="a76ed28b4b2c303c4668a3f5557e96149" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a76ed28b4b2c303c4668a3f5557e96149">d_boundary</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="class_boundary.html" title="Holds the incident and outgoing boundary fluxes.">Boundary</a> fluxes. </p>

</div>
</div>
<a class="anchor" id="a7a2fcc3c6c24a9733333c98d0f63f72c"></a><!-- doxytag: member="InnerIteration::d_equation" ref="a7a2fcc3c6c24a9733333c98d0f63f72c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a7a2fcc3c6c24a9733333c98d0f63f72c">d_equation</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Spatial discretization. </p>

</div>
</div>
<a class="anchor" id="ae86a46e183bf9e376def5751925ef97e"></a><!-- doxytag: member="InnerIteration::d_external_source" ref="ae86a46e183bf9e376def5751925ef97e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#ae86a46e183bf9e376def5751925ef97e">d_external_source</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>User-defined external source. </p>

</div>
</div>
<a class="anchor" id="ad6f82336625e3ac7774f2bdca1a637ee"></a><!-- doxytag: member="InnerIteration::d_fission_source" ref="ad6f82336625e3ac7774f2bdca1a637ee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#ad6f82336625e3ac7774f2bdca1a637ee">d_fission_source</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Fission source, if used. </p>

</div>
</div>
<a class="anchor" id="a55ba17ea0bb53d0316eb36517fa9c2de"></a><!-- doxytag: member="InnerIteration::d_fixed_source" ref="a55ba17ea0bb53d0316eb36517fa9c2de" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a55ba17ea0bb53d0316eb36517fa9c2de">d_fixed_source</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Any source that remains "fixed" within the group solve. </p>

</div>
</div>
<a class="anchor" id="a631a77bf64364cb27ca5639a3317ed30"></a><!-- doxytag: member="InnerIteration::d_g" ref="a631a77bf64364cb27ca5639a3317ed30" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a631a77bf64364cb27ca5639a3317ed30">d_g</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abc4c1c33f348e1785b286dd07ff598e9"></a><!-- doxytag: member="InnerIteration::d_input" ref="abc4c1c33f348e1785b286dd07ff598e9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#abc4c1c33f348e1785b286dd07ff598e9">d_input</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>User input. </p>

</div>
</div>
<a class="anchor" id="a7425d5935105d1b50919d9ff54305b3b"></a><!-- doxytag: member="InnerIteration::d_M" ref="a7425d5935105d1b50919d9ff54305b3b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a7425d5935105d1b50919d9ff54305b3b">d_M</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Moments to discrete operator. </p>

</div>
</div>
<a class="anchor" id="a6713318a4ce4406dea21e7c7b3c82453"></a><!-- doxytag: member="InnerIteration::d_mat" ref="a6713318a4ce4406dea21e7c7b3c82453" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a6713318a4ce4406dea21e7c7b3c82453">d_mat</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="class_materials.html">Materials</a> definitions. </p>

</div>
</div>
<a class="anchor" id="a159b3efc31946f48d126625403c25d75"></a><!-- doxytag: member="InnerIteration::d_max_iters" ref="a159b3efc31946f48d126625403c25d75" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a159b3efc31946f48d126625403c25d75">d_max_iters</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1d60598afe83dd4c518b6f698814686b"></a><!-- doxytag: member="InnerIteration::d_mesh" ref="a1d60598afe83dd4c518b6f698814686b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a1d60598afe83dd4c518b6f698814686b">d_mesh</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Problem mesh (either Cartesian mesh or MOC tracking) </p>

</div>
</div>
<a class="anchor" id="ae403c267d85e827e85d343e1d2636f85"></a><!-- doxytag: member="InnerIteration::d_quadrature" ref="ae403c267d85e827e85d343e1d2636f85" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#ae403c267d85e827e85d343e1d2636f85">d_quadrature</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Angular mesh. </p>

</div>
</div>
<a class="anchor" id="a06aa521e0ca1b107d33c3e00554352b8"></a><!-- doxytag: member="InnerIteration::d_scatter_source" ref="a06aa521e0ca1b107d33c3e00554352b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a06aa521e0ca1b107d33c3e00554352b8">d_scatter_source</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The within group scattering source. </p>

</div>
</div>
<a class="anchor" id="a9aaac6b46517fc8da97236c5c13cab41"></a><!-- doxytag: member="InnerIteration::d_sigma_s" ref="a9aaac6b46517fc8da97236c5c13cab41" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a9aaac6b46517fc8da97236c5c13cab41">d_sigma_s</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Scattering cross-section vector for faster source computation. </p>

</div>
</div>
<a class="anchor" id="a38eee99b593eb74e0865fd7e08aa068c"></a><!-- doxytag: member="InnerIteration::d_state" ref="a38eee99b593eb74e0865fd7e08aa068c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a38eee99b593eb74e0865fd7e08aa068c">d_state</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="class_state.html" title="Represents the state of the problem.">State</a> vectors. </p>

</div>
</div>
<a class="anchor" id="a6e008b8b78d0143c216d1286a134b295"></a><!-- doxytag: member="InnerIteration::d_sweeper" ref="a6e008b8b78d0143c216d1286a134b295" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a6e008b8b78d0143c216d1286a134b295">d_sweeper</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sweeper over the space-angle domain. </p>

</div>
</div>
<a class="anchor" id="a1e03c16fca26f3bdb7e055dbe935af07"></a><!-- doxytag: member="InnerIteration::d_tolerance" ref="a1e03c16fca26f3bdb7e055dbe935af07" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Property <a class="el" href="class_inner_iteration.html#a1e03c16fca26f3bdb7e055dbe935af07">d_tolerance</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/robertsj/Research/matlab_transport_pack/source/<a class="el" href="_inner_iteration_8m.html">InnerIteration.m</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Tue Feb 28 2012 22:04:42 for MatlabTransportPack by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.3 </small></address>
</body>
</html>
